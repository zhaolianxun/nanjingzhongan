<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <title>Pull to Refresh</title>
    <meta content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no,minimal-ui" name="viewport" />
    <meta name="apple-mobile-web-app-capable" content="yes" />    <style>

    </style>
</head>
<body>
<div id="dd" style="position: fixed;top:0"></div>
<!--<div class="outerScroller">-->
    <ul class = 'scroll' style="border: 1px solid red">
        <li >朋友圈1</li>
        <li>朋友圈2</li>
        <li>朋友圈3</li>
        <li>朋友圈4</li>
        <li>朋友圈5</li>
        <li>朋友圈6</li>
        <li>朋友圈7</li>
        <li>朋友圈8</li>
        <li>朋友圈9</li>
        <li>朋友圈10</li>
        <li>朋友圈1</li>
        <li>朋友圈2</li>
        <li>朋友圈3</li>
        <li>朋友圈4</li>
        <li>朋友圈5</li>
        <li>朋友圈6</li>
        <li>朋友圈7</li>
        <li>朋友圈8</li>
        <li>朋友圈9</li>
        <li>朋友圈10</li>
        <li>朋友圈1</li>
        <li>朋友圈2</li>
        <li>朋友圈3</li>
        <li>朋友圈4</li>
        <li>朋友圈5</li>
        <li>朋友圈6</li>
        <li>朋友圈7</li>
        <li>朋友圈8</li>
        <li>朋友圈9</li>
        <li>朋友圈10</li>
        <li>朋友圈1</li>
        <li>朋友圈2</li>
        <li>朋友圈3</li>
        <li>朋友圈4</li>
        <li>朋友圈5</li>
        <li>朋友圈6</li>
        <li>朋友圈7</li>
        <li>朋友圈8</li>
        <li>朋友圈9</li>
        <li>朋友圈10</li>
    </ul>
<!--</div>-->
<script>

    var scroll = document.querySelector('.scroll');
    var touchStart = 0;
    var touchDis = 0;
    window.addEventListener('touchstart', function(event) {
        var touch = event.targetTouches[0];
        // 把元素放在手指所在的位置
        document.querySelector('#dd').innerText=touch.pageY
        touchStart = touch.pageY;

        var img=document.createElement("img");
        img.id='refreshwait'
        img.style.display='none';
        img.style.width='12%';
        img.style.position='absolute';
        img.style.top='10%';
        img.style.left='50%';
        img.style.transform='translateX(-50%)';
        img.src='5-121204193R0-50.gif';

        document.body.appendChild(img);
    }, false);
    window.addEventListener('touchmove', function(event) {
        var touch = event.targetTouches[0];
        touchDis=touch.pageY-touchStart;
        document.querySelector('#dd').innerText=touchDis
        if(touchDis>10){
          document.getElementById('refreshwait').style.display='';
        }
    }, false);
    window.addEventListener('touchend', function(event) {
        touchStart = 0;
        if((touchDis>70))refresh();

            document.body.removeChild(document.getElementById('refreshwait'))



    }, false);
    function refresh(){
        //这里是后台数据
        for(var i = 3;i>0;i--)
        {
            var node = document.createElement("li");
            node.innerHTML = "I'm new" + i;
            scroll.insertBefore(node,scroll.firstChild);
        }
    }








    //--------------上拉加载更多---------------
    //获取滚动条当前的位置
    function getScrollTop() {
        var scrollTop = 0;
        if(document.documentElement && document.documentElement.scrollTop) {
            scrollTop = document.documentElement.scrollTop;
        } else if(document.body) {
            scrollTop = document.body.scrollTop;
        }
        return scrollTop;
    }

    //获取当前可视范围的高度
    function getClientHeight() {
        var clientHeight = 0;
        if(document.body.clientHeight && document.documentElement.clientHeight) {
            clientHeight = Math.min(document.body.clientHeight, document.documentElement.clientHeight);
        } else {
            clientHeight = Math.max(document.body.clientHeight, document.documentElement.clientHeight);
        }
        return clientHeight;
    }

    //获取文档完整的高度
    function getScrollHeight() {
        return Math.max(document.body.scrollHeight, document.documentElement.scrollHeight);
    }

    //滚动事件触发
    window.onscroll = function() {
        if(getScrollTop() + getClientHeight() >= getScrollHeight()) {
            var div = document.createElement("div");
            div.style.height='30px'
            div.innerText=getScrollTop()+' '+getClientHeight()+' '+getScrollHeight()
            document.body.appendChild(div)
        }
    }
    //-----------------结束--------------------
</script>
</body>
</html>