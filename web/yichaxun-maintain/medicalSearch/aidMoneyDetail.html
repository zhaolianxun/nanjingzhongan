<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <title>了解互助金</title>
    <link rel="stylesheet" href="plugins/layui/css/layui.css" media="all" />
    <link rel="stylesheet" href="css/global.css" media="all">
    <link rel="stylesheet" href="plugins/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/table.css" />
    <style>
        .layui-form-label {padding: 9px 10px;width: 85px;}.layui-form-item {margin-bottom: 25px;}
    </style>
</head>

<body>
<div class="admin-main">
    <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
        <legend id="title">互助金说明</legend>
    </fieldset>

    <form class="layui-form" action="">
        <div class="layui-form-item">
            <label class="layui-form-label">加入金额简介</label>
            <div class="layui-input-block">
                <input type="text" name="joinMoney" lay-verify="joinMoney" autocomplete="off" placeholder="请输入加入金额简介" class="layui-input">
            </div>
        </div>

        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">加入金额详情</label>
            <div class="layui-input-block">
                <textarea name="joinMoneyText" lay-verify="joinMoneyText" placeholder="请输入加入金额详情" class="layui-textarea"></textarea>
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">基本需求简介</label>
            <div class="layui-input-block">
                <input type="text" name="baseRequirement" lay-verify="baseRequirement" autocomplete="off" placeholder="请输入基本需求简介" class="layui-input">
            </div>
        </div>

        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">基本需求详情</label>
            <div class="layui-input-block">
                <textarea name="baseRequirementText" lay-verify="baseRequirementText" placeholder="请输入基本需求详情" class="layui-textarea"></textarea>
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">余额要求简介</label>
            <div class="layui-input-block">
                <input type="text" name="balanceRequirement" lay-verify="balanceRequirement" autocomplete="off" placeholder="请输入余额要求简介" class="layui-input">
            </div>
        </div>

        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">余额要求详情</label>
            <div class="layui-input-block">
                <textarea name="balanceRequirementText" lay-verify="balanceRequirementText" placeholder="请输入余额要求详情" class="layui-textarea"></textarea>
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">观察期简介</label>
            <div class="layui-input-block">
                <input type="text" name="observationPeriod" lay-verify="observationPeriod" autocomplete="off" placeholder="请输入观察期简介" class="layui-input">
            </div>
        </div>

        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">观察期详情</label>
            <div class="layui-input-block">
                <textarea name="observationPeriodText" lay-verify="observationPeriodText" placeholder="请输入观察期详情" class="layui-textarea"></textarea>
            </div>
        </div>

        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">报案介绍</label>
            <div class="layui-input-block">
                <textarea name="apply" lay-verify="apply" placeholder="请输入报案介绍" class="layui-textarea"></textarea>
            </div>
        </div>

        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">提交材料介绍</label>
            <div class="layui-input-block">
                <textarea name="submitmaterial" lay-verify="submitmaterial" placeholder="请输入提交材料介绍" class="layui-textarea"></textarea>
            </div>
        </div>

        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">审核介绍</label>
            <div class="layui-input-block">
                <textarea name="audit" lay-verify="audit" placeholder="请输入审核介绍" class="layui-textarea"></textarea>
            </div>
        </div>

        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">公示介绍</label>
            <div class="layui-input-block">
                <textarea name="show" lay-verify="show" placeholder="请输入公示介绍" class="layui-textarea"></textarea>
            </div>
        </div>

        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">给付介绍</label>
            <div class="layui-input-block">
                <textarea name="remit" lay-verify="remit" placeholder="请输入给付介绍" class="layui-textarea"></textarea>
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">顶部展示图</label>
            <div class="layui-input-block">
                <input id="topImg" type="file" name="topImg" class="layui-upload-file" lay-title="上传顶部展示图">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">展示图预览</label>
            <div class="layui-input-block">
                <img id="preview" src="">
            </div>
        </div>

        <div class="layui-form-item">
            <div class="layui-input-block">
                <button class="layui-btn" lay-submit="" lay-filter="demo1">保存</button>
            </div>
        </div>
    </form>
</div>
<script type="text/javascript" src="plugins/layui/layui.js"></script>
<script>
    layui.use(['form', 'upload'], function() {
        var $ = layui.jquery,
            form = layui.form(),
            layer = parent.layer === undefined ? layui.layer : parent.layer;

        var topImg = '';
        function getData(){
            $.ajax({
                type: 'POST',
                url: '../aidmoney/getknowaidmoneypagecontent',
                success: function(data){
                    if(data.code == 0){
                        $('[name="joinMoney"]').val(data.data.joinMoney_breiftext);
                        $('[name="joinMoneyText"]').val(data.data.joinMoney_text);
                        $('[name="baseRequirement"]').val(data.data.baseRequirement_breiftext);
                        $('[name="baseRequirementText"]').val(data.data.baseRequirement_text);
                        $('[name="balanceRequirement"]').val(data.data.balanceRequirement_breiftext);
                        $('[name="balanceRequirementText"]').val(data.data.balanceRequirement_text);
                        $('[name="observationPeriod"]').val(data.data.observationPeriod_breiftext);
                        $('[name="observationPeriodText"]').val(data.data.observationPeriod_text);
                        $('[name="apply"]').val(data.data.aidapplyflow_apply);
                        $('[name="submitmaterial"]').val(data.data.aidapplyflow_submitmaterial);
                        $('[name="audit"]').val(data.data.aidapplyflow_audit);
                        $('[name="show"]').val(data.data.aidapplyflow_show);
                        $('[name="remit"]').val(data.data.aidapplyflow_remit);
                        topImg = data.data.knowaidmoneypage_topimg;
                        $('#preview').attr('src',topImg);
                    }else{
                        layer.msg(data.message);
                    }
                }
            })
        }
        getData();

        //自定义验证规则
        form.verify({
            joinMoney:function(value){
                if(value.length == 0){
                    return '请输入加入金额简介';
                }
            },
            joinMoneyText:function(value){
                if(value.length == 0){
                    return '请输入加入金额详情';
                }
            },
            baseRequirement:function(value){
                if(value.length == 0){
                    return '请输入基本需求简介';
                }
            },
            baseRequirementText:function(value){
                if(value.length == 0){
                    return '请输入基本需求详情';
                }
            },
            balanceRequirement:function(value){
                if(value.length == 0){
                    return '请输入余额要求简介';
                }
            },
            balanceRequirementText:function(value){
                if(value.length == 0){
                    return '请输入余额要求详情';
                }
            },
            observationPeriod:function(value){
                if(value.length == 0){
                    return '请输入观察期简介';
                }
            },
            observationPeriodText:function(value){
                if(value.length == 0){
                    return '请输入观察期详情';
                }
            },
            apply:function(value){
                if(value.length == 0){
                    return '请输入报案介绍';
                }
            },
            submitmaterial:function(value){
                if(value.length == 0){
                    return '请输入提交材料介绍';
                }
            },
            audit:function(value){
                if(value.length == 0){
                    return '请输入审核介绍';
                }
            },
            show:function(value){
                if(value.length == 0){
                    return '请输入公示介绍';
                }
            },
            remit:function(value){
                if(value.length == 0){
                    return '请输入给付介绍';
                }
            }
        });

        form.on('submit(demo1)', function(data) {
            if(topImg != ''){
                var joinMoney = $('[name="joinMoney"]').val();
                var joinMoneyText = $('[name="joinMoneyText"]').val();
                var baseRequirement = $('[name="baseRequirement"]').val();
                var baseRequirementText = $('[name="baseRequirementText"]').val();
                var balanceRequirement = $('[name="balanceRequirement"]').val();
                var balanceRequirementText = $('[name="balanceRequirementText"]').val();
                var observationPeriod = $('[name="observationPeriod"]').val();
                var observationPeriodText = $('[name="observationPeriodText"]').val();
                var apply = $('[name="apply"]').val();
                var submitmaterial = $('[name="submitmaterial"]').val();
                var audit = $('[name="audit"]').val();
                var show = $('[name="show"]').val();
                var remit = $('[name="remit"]').val();

                $.ajax({
                    type: 'POST',
                    data: {joinMoney_breiftext:joinMoney,joinMoney_text:joinMoneyText,baseRequirement_breiftext:baseRequirement,baseRequirement_text:baseRequirementText,balanceRequirement_breiftext:balanceRequirement,balanceRequirement_text:balanceRequirementText,observationPeriod_breiftext:observationPeriod,observationPeriod_text:observationPeriodText,aidapplyflow_apply:apply,aidapplyflow_submitmaterial:submitmaterial,aidapplyflow_audit:audit,aidapplyflow_show:show,aidapplyflow_remit:remit,knowaidmoneypage_topimg:topImg},
                    url: '../aidmoney/setknowaidmoneypagecontent',
                    success: function(data){
                        if(data.code == 0){
                            layer.msg('修改成功！');
                        }else{
                            layer.msg(data.message);
                        }
                    }
                })
            }
            return false;
        });

        layui.upload({
            url: 'http://passion.njshangka.com/oss/file/upload?path=yichaxun/'
            ,elem: '#topImg'
            ,method: 'post'
            ,success: function(res){
                if(res.code == 0){
                    topImg = res.data.url;
                    layer.msg('顶部展示图上传成功...');
                    $('#preview').attr('src',topImg);
                }
            }
        });
    });
</script>
</body>

</html>