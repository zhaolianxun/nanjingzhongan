<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>修改用户</title>
    <link rel="stylesheet" type="text/css" href="libs/bootstrap/css/bootstrap.min.css">
    <script type="text/javascript" src="libs/jquery.min.js"></script>
    <style>
        div.control-group{
            margin: 10px 0;
        }
        label.control-label{
            font-size: 16px;
            font-weight: 300;
            padding: 5px 0;
        }
        div.inputBox{
            width: 100%;
            height: 45px;
        }
        div.inputBox>input{
            width: 100%;
            height: 45px;
            border: 1px solid #ccc;
            padding-left: 20px;
            font-size: 14px;
        }
    </style>
</head>
<body>
<div style="height:51px;border-bottom:1px solid #ddd;background:#fff">
        <span style="line-height:50px;float:left;margin-left:66px">
            <span style="margin:0 10px;display:none">/</span>
            <a href="javascript:history.go(-1)">用户列表</a> > <a href="javascript:location.reload();">修改用户</a>
        </span>
</div>
<div style="padding: 20px 40px;">
    <form class="form-horizontal">
        <div class="control-group">
            <label class="control-label" for="realname">姓名</label>
            <div class="inputBox">
                <input type="text" id="realname" placeholder="姓名">
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="password">密码</label>
            <div class="inputBox">
                <input type="password" id="password" placeholder="密码">
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="nickname">昵称</label>
            <div class="inputBox">
                <input type="text" id="nickname" placeholder="昵称">
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="phone">手机号</label>
            <div class="inputBox">
                <input type="text" id="phone" placeholder="手机号">
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="agentIss">代理</label>
            <div id="agentIss">
                <input type="radio" name="agentIs" value="1"><span>是</span>
                <input type="radio" name="agentIs" value="0"><span>否</span>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="agentCoin">代理币</label>
            <div class="inputBox">
                <input type="number" id="agentCoin" disabled  style="width: 100px;padding:0;height:30px">
            </div>
            <input type="button" value="增加" onclick="addCoin()"/><input type="button" value="减少" onclick="subCoin()" />
        </div>
        <div class="control-group" style="margin-top: 50px;">
            <button id="submit" class="btn btn-large btn-success">保存修改</button>
        </div>
    </form>
</div>

<script>
    function addCoin(){
        var coin = prompt('请输入');
        if(!coin)
            return;
        $.ajax({
            type: 'POST',
            data: {user_id:userData.userId, coin:coin*100},
            url: '/easywin/p/e/agentmanage/addagentcoin?token='+token,
            success: function(res){
                if(res.code == 0){
                    alert('修改成功！');
                    location.href = 'userlist.html';
                }else{
                    alert(res.codeMsg);
                }
            }
        });
    }

    function subCoin(){
        var coin =  prompt('请输入');
        if(!coin)
            return;
        $.ajax({
            type: 'POST',
            data: {user_id:userData.userId, coin:coin*100},
            url: '/easywin/p/e/agentmanage/subagentcoin?token='+token,
            success: function(res){
                if(res.code == 0){
                    alert('修改成功！');
                    location.href = 'userlist.html';
                }else{
                    alert(res.codeMsg);
                }
            }
        });
    }
    var token = sessionStorage.getItem('token');
    var userData = JSON.parse(sessionStorage.getItem('userData'));
    $('#realname').val(userData.realname);
    $('#nickname').val(userData.nickname);
    $('#phone').val(userData.phone);
    $('#agentCoin').val(userData.agentCoin/100);
    $("input[name=agentIs][value='" + userData.agentIs + "']").attr('checked','true');

    $('#submit').click(function(){

        var userId = userData.userId;
        var realname = $('#realname').val();
        var password = $('#password').val();
        var nickname = $('#nickname').val();
        var phone = $('#phone').val();
        var agentIs = $('input[name=agentIs]:checked').val();
        $.ajax({
            type: 'POST',
            data: {user_id:userId, realname:realname, phone:phone, password:password, nickname:nickname,agent_is:agentIs},
            url: '/easywin/p/e/usermanage/alter?token='+token,
            success: function(res){
                if(res.code == 0){
                    alert('修改成功！');
                    location.href = 'userlist.html';
                }else{
                    alert(res.codeMsg);
                }
            }
        });
        return false;
    })
</script>
</body>
</html>